<h1 id="linear-algebra">Linear Algebra<a aria-hidden="true" class="anchor-heading icon-link" href="#linear-algebra"></a></h1>
<h2 id="matrix-multiplication">Matrix Multiplication<a aria-hidden="true" class="anchor-heading icon-link" href="#matrix-multiplication"></a></h2>
<p>Matrix multiplication is multiplying one matrix by another matrix</p>
<h3 id="rules">Rules<a aria-hidden="true" class="anchor-heading icon-link" href="#rules"></a></h3>
<p>To multiply two matrices, the number of columns of the 1st matrix must equal the number of rows of the 2nd matrix.</p>
<ul>
<li>visualized a different way, to multiply two matrices the inner dimensions must match. 
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo><mi mathvariant="normal">@</mi><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(3, 2) @ (2, 3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mord">@</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span> indicates 2 matrices, the first of which has 3 arrays of size 2, while the second has 2 arrays of size 3. Here, the inner values (ie. those closest to the <code>@</code>) are <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></span>, so this works. By the same token, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo><mi mathvariant="normal">@</mi><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2, 3) @ (2, 3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mord">@</span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span> won't work because the inner values (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">3</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span></span>) are not the same. To be able to multiply either of these matrices, we'd have to transpose one of them.</li>
</ul>
</li>
</ul>
<p>The result of the calculation will have the same number of rows as the 1st matrix, and the same number of columns as the 2nd matrix.</p>
<ul>
<li>visualized a different way, the resulting matrix will have the shape of the outer dimensions
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo><mi mathvariant="normal">@</mi><mo stretchy="false">(</mo><mn>3</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2, 3) @ (3, 2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mord">@</span><span class="mopen">(</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span> will result in a matrix with dimensions <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2</mn><mo separator="true">,</mo><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2, 2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span></li>
</ul>
</li>
</ul>
<h3 id="how-it-works">How it works<a aria-hidden="true" class="anchor-heading icon-link" href="#how-it-works"></a></h3>
<p>To derive the result, we need to do the <em>dot product</em> of rows and columns.</p>
<ul>
<li>ex. for a single row and single column, we would get the result like this:</li>
</ul>
<p><img src="/assets/images/2023-07-11-08-43-59.png"></p>
<p>Because:</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">)</mo><mtext>•</mtext><mo stretchy="false">(</mo><mn>7</mn><mo separator="true">,</mo><mn>9</mn><mo separator="true">,</mo><mn>11</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>×</mo><mn>7</mn><mo>+</mo><mn>2</mn><mo>×</mo><mn>9</mn><mo>+</mo><mn>3</mn><mo>×</mo><mn>11</mn><mo>=</mo><mn>58</mn></mrow><annotation encoding="application/x-tex">(1, 2, 3) • (7, 9, 11) = 1×7 + 2×9 + 3×11 = 58</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">3</span><span class="mclose">)</span><span class="mord">•</span><span class="mopen">(</span><span class="mord">7</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">9</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">11</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">11</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">58</span></span></span></span></span></p>
<p>For a matrix such as this, we need to multiply the following combinations:</p>
<ul>
<li>row 1 • column 1</li>
<li>row 1 • column 2</li>
<li>row 2 • column 1</li>
<li>row 2 • column 2</li>
</ul>
<p>Unlike multiplication of scalars, matrix multiplication is not <strong>commutative</strong></p>
<ul>
<li>this means that AB ≠ BA</li>
</ul>
<h4 id="pytorch-example">Pytorch example<a aria-hidden="true" class="anchor-heading icon-link" href="#pytorch-example"></a></h4>
<pre class="language-py"><code class="language-py">tensor1 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tensor2 <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
new_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>tensor<span class="token punctuation">,</span> tensor2<span class="token punctuation">)</span>
<span class="token comment"># tensor([[ 58,  64],</span>
<span class="token comment">#         [139, 154]])</span>
</code></pre>
<h4 id="why-do-we-calculate-like-this">Why do we calculate like this?<a aria-hidden="true" class="anchor-heading icon-link" href="#why-do-we-calculate-like-this"></a></h4>
<p>There has to be some relation between the 1st and 2nd matrix.</p>
<ul>
<li>ex. the 1st matrix represents units of fruit sold (broken down by fruit type) and the 2nd matrix represents the cost per fruit type</li>
</ul>
<p>If we consider it like this, then we need to add up all the "total values" of the sales of each fruit. How we do this is by multiplying each individual fruit price by the quantity of that price sold, then performing the same operation for each fruit, and finally adding them all up:</p>
<p>Apple pie value + Cherry pie value + Blueberry pie value</p>
<p>$3×13 + $4×8 + $2×6 = $83</p>
<h4 id="identity-matrix">Identity Matrix<a aria-hidden="true" class="anchor-heading icon-link" href="#identity-matrix"></a></h4>
<p>An <em>identity matrix</em> is the equivalent of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>, when it comes to identity multiplication</p>
<ul>
<li>that is, when we multiply X by 1, the answer is X. In the same way, if we multiply Matrix Y by the identity matrix, the answer is Matrix Y</li>
</ul>
<pre class="language-py"><code class="language-py">IdentityMatrix <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">]</span>
    <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">]</span>
    <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">]</span>
<span class="token punctuation">]</span>
</code></pre>
<p>The identity matrix can be any row/column length, as long as it follows the pattern of diagonal ones from top left to bottom right.</p>
<h2 id="e-resources">E Resources<a aria-hidden="true" class="anchor-heading icon-link" href="#e-resources"></a></h2>
<ul>
<li><a href="https://www.mathsisfun.com/algebra/matrix-multiplying.html">https://www.mathsisfun.com/algebra/matrix-multiplying.html</a></li>
</ul>
<h2 id="ue-resources">UE Resources<a aria-hidden="true" class="anchor-heading icon-link" href="#ue-resources"></a></h2>
<p><a href="https://www.youtube.com/watch?v=fNk_zzaMoSs&#x26;list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab">3Blue1Brown series on Linear Algebra</a></p>
<h2 id="resources">Resources<a aria-hidden="true" class="anchor-heading icon-link" href="#resources"></a></h2>
<ul>
<li><a href="http://matrixmultiplication.xyz/">Visualizing matrix multiplication</a></li>
</ul>
<hr>
<strong>Children</strong>
<ol>
<li><a href="/notes/g7zb77rl56gp6qekh4pqp52">Tensors</a></li>
<li><a href="/notes/s8fo55e9s2iap0au3y9hmee">Vector</a></li>
</ol>